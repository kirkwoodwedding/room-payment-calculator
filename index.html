<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Room Payment Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Poppins', sans-serif;
    }

    .background-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .bg-map {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 1;
    }

    .content-container {
      max-width: 500px;
      margin: 40px auto;
      background: rgba(162, 178, 159, 0.6);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      min-height: 100vh;
      position: relative;
      z-index: 1;
      line-height: 1.5;
      color: #333;
    }

    label, select, button {
      font-family: 'Poppins', sans-serif;
    }

    select, button {
      width: 100%;
      margin-bottom: 15px;
      padding: 10px;
      font-size: 1rem;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    button {
      background-color: #5d7263;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #4a5d50;
    }

    .result {
      font-weight: bold;
      margin-top: 10px;
      font-size: 1.2rem;
    }

    .booking-section {
      background-color: rgba(255, 255, 255, 0.75);
      margin-top: 40px;
      padding: 20px;
      border-radius: 8px;
      font-size: 0.95rem;
    }

    .booking-section h2 {
      margin-top: 0;
    }

    .booking-section a {
      color: #4a5d50;
      font-weight: bold;
      text-decoration: none;
    }

    .booking-section a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="background-container">
    <img src="https://kirkwoodwedding.github.io/room-payment-calculator/watercolor2.JPG" alt="Background" class="bg-map" />
  </div>

  <div class="content-container">
    <h1>Room Payment Calculator</h1>

    <label for="roomType">Select Room Type:</label>
    <select id="roomType">
      <option value="" disabled selected>Select room</option>
      <option value="juniorSuite">Junior Suite</option>
      <option value="juniorSuiteOceanView">Junior Suite Ocean View</option>
      <option value="inspiraSwimOut">INSPIRA Swim Out</option>
      <option value="inspiraTerrace">Inspira Terrace</option>
    </select>

    <label for="occupancy">Number of Guests in Room:</label>
    <select id="occupancy">
      <option value="" disabled selected>Select occupancy</option>
      <option value="single">Single</option>
      <option value="double">Double</option>
      <option value="triple">Triple</option>
    </select>

    <label for="nights">Number of Nights:</label>
    <select id="nights">
      <option value="" disabled selected>Select nights</option>
      <option value="3">3 Nights</option>
      <option value="4">4 Nights</option>
      <option value="5">5 Nights</option>
    </select>

    <button id="calculateBtn">Calculate Payment</button>

    <div class="result" id="result"></div>

    <div id="calendarOptions" style="display:none; margin-top: 15px;">
      <label for="calendarDate">Add Reminder For:</label>
      <select id="calendarDate">
        <option value="second">2nd Payment â€“ December 11, 2025</option>
        <option value="final">Final Payment â€“ March 10, 2026</option>
      </select>

      <button id="downloadICSBtn">Download ICS File</button>
      <button id="googleCalBtn">Add to Google Calendar</button>
    </div>

    <div class="booking-section">
      <h2>Booking and Payment Information</h2>
      <p>
        A $400 deposit secures your spot and counts toward your total stay. 
        Weâ€™ve got a block of rooms held just for our guests, but availability is limited! 
        Reserve your spot early, avoid the last-minute scramble, and get ready for some serious R&R (plus a little wedding magic with âœ¨ D&R âœ¨)
      </p>

      <p><strong>Payment Timeline:</strong></p>
      <ul>
        <li><strong>Deposit:</strong> $400 â€” Due <strong>as soon as you're ready to book</strong></li>
        <li><strong>2nd Payment (50% minus deposit):</strong> Due <strong>December 11, 2025</strong></li>
        <li><strong>Final Payment (remaining 50%):</strong> Due <strong>March 10, 2026</strong></li>
      </ul>

      <p><strong>Ready to Book?</strong><br>
        Contact our travel agent <strong>Linda Pacey</strong>:<br>
        ðŸ“§ <a href="mailto:Linda@blissfulhoneymoons.com">Linda@blissfulhoneymoons.com</a><br>
        ðŸ“ž <a href="tel:6207981120">620-798-1120</a>
      </p>

      <p>
        Or book directly here: <br>
        ðŸ”— <a href="https://www.vacationcrm.com/IFrameRegistration?lookup_id=95f1f7de-6844-4e22-8db0-e0c4fa33c39d" target="_blank">Make a payment</a>
      </p>
    </div>
  </div>

  <script>
    const prices = {
      juniorSuite: {
        single: {3: 1654.99, 4: 2192.65, 5: 2730.31},
        double: {3: 1981.40, 4: 2613.88, 5: 3246.34},
        triple: {3: 2974.05, 4: 3923.40, 5: 4872.75}
      },
      juniorSuiteOceanView: {
        single: {3: 1717.32, 4: 2275.77, 5: 2834.21},
        double: {3: 2051.54, 4: 2707.38, 5: 3363.22},
        triple: {3: 3079.26, 4: 4063.65, 5: 5048.07}
      },
      inspiraSwimOut: {
        single: {3: 3139.40, 4: 4171.87, 5: 5204.34},
        double: {3: 3181.40, 4: 4213.88, 5: 5246.34},
        triple: {3: 4770.15, 4: 6318.21, 5: 7866.27}
      },
      inspiraTerrace: {
        single: {3: 3139.40, 4: 4171.87, 5: 5204.34},
        double: {3: 3181.40, 4: 4213.88, 5: 5246.34},
        triple: {3: 4770.15, 4: 6318.21, 5: 7866.27}
      }
    };

    const deposit = 400;
    const roomTypeSelect = document.getElementById('roomType');
    const occupancySelect = document.getElementById('occupancy');
    const nightsSelect = document.getElementById('nights');
    const calculateBtn = document.getElementById('calculateBtn');
    const resultDiv = document.getElementById('result');
    const calendarOptions = document.getElementById('calendarOptions');
    const calendarDateSelect = document.getElementById('calendarDate');
    const downloadICSBtn = document.getElementById('downloadICSBtn');
    const googleCalBtn = document.getElementById('googleCalBtn');

    function formatCurrency(amount) {
      return amount.toLocaleString('en-US', {style: 'currency', currency: 'USD'});
    }

    function calculatePayments(roomType, occupancy, nights) {
      const total = prices[roomType]?.[occupancy]?.[nights];
      if (!total) return null;

      // 2nd payment: 50% of total minus deposit
      const secondPayment = (total / 2) - deposit;
      // Final payment: remaining 50%
      const finalPayment = total / 2;

      return {
        total,
        deposit,
        firstPayment: secondPayment,
        finalPayment,
        firstDue: "December 11, 2025",
        finalDue: "March 10, 2026"
      };
    }

    calculateBtn.addEventListener('click', () => {
      const roomType = roomTypeSelect.value;
      const occupancy = occupancySelect.value;
      const nights = parseInt(nightsSelect.value, 10);

      if (!roomType || !occupancy || !nights) {
        alert('Please select all options before calculating.');
        return;
      }

      const plan = calculatePayments(roomType, occupancy, nights);
      if (!plan) {
        resultDiv.textContent = 'Unable to calculate payment for the selected options.';
        calendarOptions.style.display = 'none';
        return;
      }

      displayResult(plan);
    });

    function displayResult(plan) {
      resultDiv.innerHTML = `
        Total Room Price: ${formatCurrency(plan.total)}<br>
        Deposit Due Now: ${formatCurrency(plan.deposit)}<br>
        2nd Payment Due ${plan.firstDue}: ${formatCurrency(plan.firstPayment)}<br>
        Final Payment Due ${plan.finalDue}: ${formatCurrency(plan.finalPayment)}
      `;
      calendarOptions.style.display = 'block';
    }

    // ICS and Google Calendar support

    function getReminderDate(type) {
      return type === 'second' ? '2025-12-11' : '2026-03-10';
    }

    function formatICSDate(date) {
      // YYYYMMDDTHHMMSSZ format
      return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
    }

    function createICS(dateStr, title) {
      const start = new Date(dateStr + 'T09:00:00');
      const end = new Date(start.getTime() + 60 * 60 * 1000); // 1 hour later

      const startDate = formatICSDate(start);
      const endDate = formatICSDate(end);

      const icsContent =
        'BEGIN:VCALENDAR\n' +
        'VERSION:2.0\n' +
        'BEGIN:VEVENT\n' +
        'UID:' + Date.now() + '@kirkwoodwedding.com\n' +
        'DTSTAMP:' + formatICSDate(new Date()) + '\n' +
        'SUMMARY:' + title + '\n' +
        'DESCRIPTION:Room payment reminder for ' + title + '\n' +
        'LOCATION:Online\n' +
        'DTSTART:' + startDate + '\n' +
        'DTEND:' + endDate + '\n' +
        'END:VEVENT\n' +
        'END:VCALENDAR';

      const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `payment-reminder-${dateStr}.ics`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function openGoogleCalendar(dateStr, title) {
      const start = new Date(dateStr + 'T09:00:00');
      const end = new Date(start.getTime() + 60 * 60 * 1000);

      function formatGoogleDate(date) {
        return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
      }

      const details = encodeURIComponent('Room payment reminder for ' + title);
      const location = encodeURIComponent('Online');
      const dates = `${formatGoogleDate(start)}/${formatGoogleDate(end)}`;
      const url = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${dates}&details=${details}&location=${location}`;

      window.open(url, '_blank');
    }

    downloadICSBtn.addEventListener('click', () => {
      const type = calendarDateSelect.value;
      const dateStr = getReminderDate(type);
      const title = type === 'second' ? '2nd Room Payment Due' : 'Final Room Payment Due';
      createICS(dateStr, title);
    });

    googleCalBtn.addEventListener('click', () => {
      const type = calendarDateSelect.value;
      const dateStr = getReminderDate(type);
      const title = type === 'second' ? '2nd Room Payment Due' : 'Final Room Payment Due';
      openGoogleCalendar(dateStr, title);
    });
  </script>
</body>
</html>
